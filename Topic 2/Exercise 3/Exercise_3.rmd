---
title: 'Topic 2: Exercise 1'
author: "Daniel Alonso"
date: "November 28th, 2020"
output: 'pdf_document'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "./figures/"
)
knitr::knit_engines$set(julia = JuliaCall::eng_juliacall)
```


#### Importing libraries

```{r, echo=TRUE, warning=FALSE, message=FALSE}
library(dplyr)
library(Rcpp)
```

#### Importing data as described by exercise

```{r, echo=TRUE, warning=FALSE, message=FALSE}
d <- read.csv("../../datasets/Colleges.csv")
```

#### Replacing binary variable Private with 1 and 0

```{r, echo=TRUE, warning=FALSE, message=FALSE}
d$Private <- ifelse(d$Private == "Yes", 1, 0)
```

#### Selecting columns

```{r, echo=TRUE, warning=FALSE, message=FALSE}
data <- d %>% dplyr::select('Private','Apps','Accept','Enroll','F.Undergrad')
```

#### Calculating covariances

```{r, echo=TRUE, warning=FALSE, message=FALSE}
cov_matrix <- cov(data)
cov_matrix
```

\newpage

#### Calculating correlations

```{r, echo=TRUE, warning=FALSE, message=FALSE}
corr_matrix <- cov2cor(cov_matrix)
corr_matrix
```

#### Experimenting a little bit with the private variable

Let's try changing the Yes to 0 and the No to 1 and checking the covariances and correlations

```{r, echo=TRUE, warning=FALSE, message=FALSE}
d <- read.csv("../../datasets/Colleges.csv")
d$Private <- ifelse(d$Private == "Yes", 0, 1)
data <- d %>% dplyr::select('Private','Apps','Accept','Enroll','F.Undergrad')
```

```{r, echo=TRUE, warning=FALSE, message=FALSE}
cov_matrix <- cov(data)
cov_matrix
corr_matrix <- cov2cor(cov_matrix)
corr_matrix
```

We get the same numbers with reversed signs.

\newpage

We define the following function (in julia) to help our understanding:
    
Takes the arguments:

    - nrows: number of data to simulate (amount of rows)
    - simulations: number of different times to simulate and average the results
    - fixed_value_col: boolean parameter with true -> assigns a set of values between mins[1] and maxs[1] (other 2 parameters)
    - reverse: 

```{julia}
using Random
using Statistics
using Plots
gr()

function simulation_general(nrows, simulations; fixed_value_col=false, reverse=false, sim_binaries=true, mins=[1,100], maxs=[10,10000]) 
    # cov and corr matrixes
    covs = zeros(Float64, nrows, simulations)
    corr = zeros(Float64, nrows, simulations)

    # loop
    for s in 1:simulations
        pvtapps = zeros(Float64, nrows, 3)
        if sim_binaries == false
            pvtapps[:,1] = rand(0:1, nrows)
        end

        # random numbers column (quant variable)
        if fixed_value_col == true
            pvtapps[:,2] = rand(mins[1]:maxs[1],nrows)
        else
            if reverse == false
                pvtapps[:,2] = rand(mins[1]:maxs[1],nrows)
                pvtapps[:,3] = rand(mins[2]:maxs[2],nrows)
            else 
                pvtapps[:,2] = rand(mins[2]:maxs[2],nrows)
                pvtapps[:,3] = rand(mins[1]:maxs[1],nrows)
            end
        end

        # loop for changing values
        for i in 1:nrows

            if sim_binaries == true
                pvtapps[1:i,1] = ones(i)
            end

            pvtapps[1:i,2] = pvtapps[1:i,3]

            # calculate corr and cov
            covs[i,s] = cov(pvtapps[:,1],pvtapps[:,2])
            corr[i,s] = cor(pvtapps[:,1],pvtapps[:,2])
        end
    end

    # results
    covsrows = zeros(Float64, nrows)
    corrrows = zeros(Float64, nrows)
    for i in 1:nrows
        covsrows[i] = mean(covs[i,:])
        corrrows[i] = mean(corr[i,:])
    end

    # return matrixes
    return covsrows, corrrows
end

covsrows, corrrows = simulation_general(500,100, reverse=true, sim_binaries=true);
```

```{r, echo=TRUE, warning=FALSE, message=FALSE}
covsrows <- JuliaCall::julia_eval("covsrows")
plot(covsrows)
corrrows <- JuliaCall::julia_eval("corrrows")
plot(corrrows)
```

# OBSERVATIONS

Now let's play around changing the size of the values that correspond in the quantitative variable to 1s or 0s in the binary column.



## What information does the sample covariance provide?

We know that because the Private variable (binary variable) has only 2 possible values, its covariance with other variables is always going to be relatively small and will not provide much information.

\newpage

## What information does the sample correlation provide?



